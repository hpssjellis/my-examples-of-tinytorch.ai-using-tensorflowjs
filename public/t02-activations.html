<!DOCTYPE html>
<html>
<head>
    <title>TensorFlow.js Activation Functions (TinyTorch 02)</title>
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0"></script>

<h2 align=center>TensorFlow.js Activation Functions - TinyTorch Style</h2>

<br>See the video <a href="https://www.youtube.com/watch?v=ACQy0FhL5RY&list=PL57Dnr1H_egukaDgFqwEnDVStd7Jktg1E&index=2"> here. </a><br>
<iframe width="250" height="140" src="https://www.youtube.com/embed/ACQy0FhL5RY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><br><br><br>

<div style="font-size:15px; background-color:lightyellow; width:88%;Â  border:5px solid blue; padding:5px; margin:5px;">Â 
This page demonstrates **Activation Functions**, which introduce **non-linearity** to the neural network. We implement the **Forward Pass** of key functions from scratch (the TinyTorch way) and then use the optimized TF.js version.
<ol>Â Â 
Â  Â  <li><b>ReLU (Rectified Linear Unit)</b>: The industry standard for hidden layers.
Â  Â  <li><b>Sigmoid</b>: Used primarily for binary classification output (0 to 1).
Â  Â  <li><b>Softmax</b>: Used exclusively for multi-class classification output (probabilities that sum to 1).
Â  Â  <li>**"Show How, Then Use" Strategy**: Custom JavaScript functions vs. optimized TF.js.
</ol>
</div><br>

<div id="myDiv321Code">Â 

<script>
// NOTE: All code is compressed to maintain the line-break dependencies for the live-edit feature.
// Helper function formats tensors with shape information
async function myTensorTable(myDiv, myOutTensor, myCols, myTitle){Â  Â 
Â document.getElementById(myDiv).innerHTML += '<b>' + myTitle + '</b><br>'
Â document.getElementById(myDiv).innerHTML += '<span style="color:blue;">Shape: [' + myOutTensor.shape.join(' Ã— ') + '] | Size: ' + myOutTensor.size + '</span><br>'
Â const myOutput = await myOutTensor.data()
Â myTemp = '<table border=3><tr>'
Â  Â for (myCount = 0;Â  Â  myCount <= myOutTensor.size - 1;Â  Â myCount++){Â  Â 
Â  Â  Â myTemp += '<td>'+ myOutput[myCount].toFixed(4) + '</td>'
Â  Â  Â if (myCount % myCols == myCols-1){
Â  Â  Â  Â  Â myTemp += '</tr><tr>'
Â  Â  Â }
Â  Â }Â  Â 
Â  Â myTemp += '</tr></table>'
Â  Â document.getElementById(myDiv).innerHTML += myTemp + '<br>'
}
Â  Â Â 
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Â  Â  Â  Â 
// 1. TinyTorch-Style (Pure JS) Implementations for Forward Pass
// ReLU: max(0, x)
function myReluFromScratch(myArray){return myArray.map(myElement => Math.max(0, myElement));}
// Sigmoid: 1 / (1 + e^-x)
function mySigmoidFromScratch(myArray){return myArray.map(myElement => 1 / (1 + Math.exp(-myElement)));}
// Softmax: e^x_i / sum(e^x) (Uses a common stability trick)
function mySoftmaxFromScratch(myLogitsArray){const myMaxLogit=Math.max(...myLogitsArray);const myExponentsArray=myLogitsArray.map(myLogit=>Math.exp(myLogit-myMaxLogit));const mySumExponents=myExponentsArray.reduce((myAccumulator,myCurrentValue)=>myAccumulator+myCurrentValue,0);return myExponentsArray.map(myExponent=>myExponent/mySumExponents);}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Â  Â 

async function myTest321(){
Â 
Â  document.getElementById('myDiv321').innerHTML ='<h3>ğŸ§  TinyTorch 02: Activation Functions in Action</h3><br>'Â Â 
Â 
Â  const myLogits = [-3.0, 0.0, 1.5, 4.0] // Example raw scores (logits)
Â  const myLogitsTensor = tf.tensor1d(myLogits)
Â 
Â  document.getElementById('myDiv321').innerHTML +='<h4>Input Data (Logits)</h4>'
Â  await myTensorTable('myDiv321', myLogitsTensor, 4, 'Input Logits (1D Tensor)')
Â  document.getElementById('myDiv321').innerHTML += '<hr><br>'
Â 
Â 
Â  // ========== SECTION 1: ReLU (Rectified Linear Unit) ==========
Â  document.getElementById('myDiv321').innerHTML +='<h4>1ï¸âƒ£ ReLU: max(0, x)</h4>'
Â  document.getElementById('myDiv321').innerHTML +='<i>Passes positive values, sets negative values to zero.</i><br>'
Â  document.getElementById('myDiv321').innerHTML +='<span style="color:red;">Derivative is 1 for x>0, 0 for x<=0.</span><br><br>'
Â 
Â  // Custom Implementation
Â  const myReluResult = myReluFromScratch(myLogits)
Â  document.getElementById('myDiv321').innerHTML +='<b>Custom myReluFromScratch (Pure JS)</b><br>'
Â  document.getElementById('myDiv321').innerHTML +='Result: [' + myReluResult.map(p => p.toFixed(2)).join(', ') + ']<br><br>'
Â 
Â  // Optimized TF.js Implementation
Â  const myTfRelu = myLogitsTensor.relu()
Â  await myTensorTable('myDiv321', myTfRelu, 4, 'Optimized tf.relu()')
Â  myTfRelu.dispose()
Â 
Â  document.getElementById('myDiv321').innerHTML += '<hr><br>'
Â 
Â 
Â  // ========== SECTION 2: Sigmoid ==========
Â  document.getElementById('myDiv321').innerHTML +='<h4>2ï¸âƒ£ Sigmoid: $\\sigma(x) = \\frac{1}{1 + e^{-x}}$</h4>'
Â  document.getElementById('myDiv321').innerHTML +='<i>Compresses values into a range of [0, 1], useful for binary output.</i><br>'
Â  document.getElementById('myDiv321').innerHTML +='<span style="color:red;">Derivative is $\\sigma(x) \\cdot (1 - \\sigma(x))$.</span><br><br>'
Â 
Â  // Custom Implementation
Â  const mySigmoidResult = mySigmoidFromScratch(myLogits)
Â  document.getElementById('myDiv321').innerHTML +='<b>Custom mySigmoidFromScratch (Pure JS)</b><br>'
Â  document.getElementById('myDiv321').innerHTML +='Result: [' + mySigmoidResult.map(p => p.toFixed(4)).join(', ') + ']<br><br>'
Â 
Â  // Optimized TF.js Implementation
Â  const myTfSigmoid = myLogitsTensor.sigmoid()
Â  await myTensorTable('myDiv321', myTfSigmoid, 4, 'Optimized tf.sigmoid()')
Â  myTfSigmoid.dispose()
Â 
Â  document.getElementById('myDiv321').innerHTML += '<hr><br>'
Â 
Â 
Â  // ========== SECTION 3: Softmax ==========
Â  document.getElementById('myDiv321').innerHTML +='<h4>3ï¸âƒ£ Softmax: Probabilities for Multi-Class Classification</h4>'
Â  document.getElementById('myDiv321').innerHTML +='<i>Converts raw scores into a probability distribution that sums to 1.</i><br>'
Â  document.getElementById('myDiv321').innerHTML +='<span style="color:red;">Derivative is complex, involving the Jacobian matrix.</span><br><br>'
Â 
Â  // Custom Implementation
Â  const mySoftmaxResult = mySoftmaxFromScratch(myLogits)
Â  document.getElementById('myDiv321').innerHTML +='<b>Custom mySoftmaxFromScratch (Pure JS)</b><br>'
Â  document.getElementById('myDiv321').innerHTML +='Result: [' + mySoftmaxResult.map(p => p.toFixed(4)).join(', ') + ']<br>'
Â  document.getElementById('myDiv321').innerHTML +='Sum of Probabilities: ' + mySoftmaxResult.reduce((a, b) => a + b, 0).toFixed(4) + '<br><br>'
Â 
Â  // Optimized TF.js Implementation
Â  const myTfSoftmax = myLogitsTensor.softmax()
Â  await myTensorTable('myDiv321', myTfSoftmax, 4, 'Optimized tf.softmax()')
Â 
Â  // Check sum on TF.js result
Â  const mySumCheck = myTfSoftmax.sum()
Â  document.getElementById('myDiv321').innerHTML +='TF.js Sum Check: ' + (await mySumCheck.data())[0].toFixed(4) + '<br>'
Â 
Â  myTfSoftmax.dispose()
Â  mySumCheck.dispose()
Â  myLogitsTensor.dispose()
Â 
Â  document.getElementById('myDiv321').innerHTML += '<hr><br>'
Â 
Â 
Â  document.getElementById('myDiv321').innerHTML +='<h3>ğŸ“ Key Takeaways</h3>'
Â  document.getElementById('myDiv321').innerHTML +='<ul>'
Â  document.getElementById('myDiv321').innerHTML +='<li><b>Activations provide Non-Linearity</b>: They let the network learn complex patterns.</li>'
Â  document.getElementById('myDiv321').innerHTML +='<li><b>Forward Pass</b>: The mathematical formula (what we implemented with our "my" functions).</li>'
Â  document.getElementById('myDiv321').innerHTML +='<li><b>Backward Pass (Gradient)</b>: The derivative, which is critical for learning, is handled by TF.js.</li>'
Â  document.getElementById('myDiv321').innerHTML +='<li><b>Choice Matters</b>: ReLU for hidden layers, Sigmoid/Softmax for output layers.</li>'
Â  document.getElementById('myDiv321').innerHTML +='</ul>'
}

</script>

<input type="button" id="myButton321" value="Run All" onclick="{
Â  Â  myTest321();
}"><br><br><br>

</div>
<div id='myDiv321'>...</div><br>

<input id="myUpdate321"Â  type=button value="Update and Run" style="visibility:hidden;" onclick="{

Â  Â // 1. Remove the injected wrapper lines from the textarea value
Â  myFred = document.getElementById('myTextarea321').value.split('\n')
Â  myFred.pop()
Â  myFred.push('')
Â  myFred.shift()
Â  myFred.shift()
Â  myJoe = myFred.join('\n')

Â  Â // 2. Clear the old code container content
Â  document.getElementById('myDiv321Code').innerHTML = ''
Â 
Â  Â // 3. Create a new executable script element
Â  const myNewScript = document.createElement('script')
Â  myNewScript.textContent = myJoe
Â 
Â  Â // 4. Append the new script to the container (which executes it)
Â  document.getElementById('myDiv321Code').appendChild(myNewScript)
Â 
Â  Â // 5. Run the newly defined function
Â  document.getElementById('myButton321').click()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
}"><br>

<textarea id="myTextarea321"Â  Â wrap="off"Â  style= "font-size:15px; color:white; background-color:black; width:90%;"Â  Â rows=2 onclick="{
Â  if (myOnce321){
Â  Â  Â myTextGrow('myTextarea321', 'myDiv321Code')
Â  Â  Â document.getElementById('myUpdate321').style.visibility = 'visible'
Â  Â  Â myOnce321 = false
Â  }
}">
Click here to see the working HTML code.
</textarea><br>

<br><br><br><hr><br><br><br><br>

This <a href="https://github.com/hpssjellis/beginner-tensorflowjs-examples-in-javascript">Github</a>, ...Â Â 
this <a href="https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/">Github Website Version</a>, ...Â 
this <a href="http://rocksetta.com/tensorflowjs/">Hosted Website Version</a>, ...Â 
<a href="https://js.tensorflow.org/">Tensorflowjs</a> <br> <br>

By Jeremy Ellis <br>
Twitter<a href="https://twitter.com/@rocksetta">@rocksetta</a><br>
Website <a href="http://rocksetta.com">http://rocksetta.com</a><br>
Use at your own risk!

<script>

myOnce321 = trueÂ  Â  // so textareas are only clicked once

function myTextGrow(myT, myB){
Â  Â var myCursorStart = document.getElementById(myT).selectionStart
Â  Â var myCursorEnd = document.getElementById(myT).selectionEnd

Â  Â myDivName = myB.replace('Code','')
Â  Â document.getElementById(myT).value = '\x3Cscript src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0"> \x3C/script> \n\n' + document.getElementById(myB).innerHTMLÂ 
Â  Â document.getElementById(myT).value += '<div id=\''+myDivName+'\'>...</div><br>'Â  Â  Â 
Â  Â setTimeout(function() {
Â  Â  Â  while (Â  document.getElementById(myT).clientHeight < document.getElementById(myT).scrollHeight){Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  document.getElementById(myT).rows += 3;Â 
Â  Â  Â  }Â 
Â  Â }, 100)

Â  document.getElementById(myT).selectionStart = myCursorStart
Â  document.getElementById(myT).selectionEnd = myCursorEnd
}Â Â 

</script>Â  Â Â 
Â 
</body>
</html>
